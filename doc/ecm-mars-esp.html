<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="José Mauricio Gómez Julián" />


<title>Detalles Metodológicos del Modelo de Corrección de Errores con MARS</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore"><strong>Detalles Metodológicos del Modelo
de Corrección de Errores con MARS</strong></h1>
<h4 class="author">José Mauricio Gómez Julián</h4>
<h4 class="date">septiembre 2025</h4>


<div id="TOC">
<ul>
<li><a href="#marco-econom%C3%A9trico-para-el-an%C3%A1lisis-de-cointegraci%C3%B3n-y-correcci%C3%B3n-de-errores" id="toc-marco-econométrico-para-el-análisis-de-cointegración-y-corrección-de-errores"><strong>Marco
Econométrico para el Análisis de Cointegración y Corrección de
Errores</strong></a>
<ul>
<li><a href="#determinaci%C3%B3n-de-orden-de-integraci%C3%B3n-i1" id="toc-determinación-de-orden-de-integración-i1"><strong>Determinación
de Orden de Integración I(1)</strong></a>
<ul>
<li><a href="#fundamento-te%C3%B3rico" id="toc-fundamento-teórico"><strong>Fundamento Teórico</strong></a></li>
<li><a href="#protocolo-de-verificaci%C3%B3n" id="toc-protocolo-de-verificación"><strong>Protocolo de
Verificación</strong></a></li>
<li><a href="#justificaci%C3%B3n-del-nivel-de-significancia" id="toc-justificación-del-nivel-de-significancia"><strong>Justificación
del Nivel de Significancia</strong></a></li>
</ul></li>
<li><a href="#an%C3%A1lisis-de-cointegraci%C3%B3n" id="toc-análisis-de-cointegración"><strong>Análisis de
Cointegración</strong></a>
<ul>
<li><a href="#enfoque-dual-engle-granger-y-johansen" id="toc-enfoque-dual-engle-granger-y-johansen"><strong>Enfoque Dual:
Engle-Granger y Johansen</strong></a></li>
<li><a href="#justificaci%C3%B3n-de-la-regla-either" id="toc-justificación-de-la-regla-either"><strong>Justificación de la
Regla “Either”</strong></a></li>
</ul></li>
<li><a href="#modelo-de-correcci%C3%B3n-de-errores-ecm" id="toc-modelo-de-corrección-de-errores-ecm"><strong>Modelo de
Corrección de Errores (ECM)</strong></a>
<ul>
<li><a href="#especificaci%C3%B3n-del-ecm-lineal" id="toc-especificación-del-ecm-lineal"><strong>Especificación del ECM
Lineal</strong></a></li>
<li><a href="#selecci%C3%B3n-%C3%B3ptima-de-rezagos" id="toc-selección-óptima-de-rezagos"><strong>Selección Óptima de
Rezagos</strong></a></li>
<li><a href="#test-unidireccional-con-errores-hac" id="toc-test-unidireccional-con-errores-hac"><strong>Test Unidireccional
con Errores HAC</strong></a></li>
</ul></li>
<li><a href="#extensi%C3%B3n-no-lineal-con-mars" id="toc-extensión-no-lineal-con-mars"><strong>Extensión No-Lineal con
MARS</strong></a>
<ul>
<li><a href="#motivaci%C3%B3n-econ%C3%B3mica" id="toc-motivación-económica"><strong>Motivación
Económica</strong></a></li>
<li><a href="#especificaci%C3%B3n-del-modelo-mars-ecm" id="toc-especificación-del-modelo-mars-ecm"><strong>Especificación del
Modelo MARS-ECM</strong></a></li>
<li><a href="#configuraci%C3%B3n-de-hiperpar%C3%A1metros" id="toc-configuración-de-hiperparámetros"><strong>Configuración de
Hiperparámetros</strong></a></li>
</ul></li>
<li><a href="#validaci%C3%B3n-cruzada-temporal" id="toc-validación-cruzada-temporal"><strong>Validación Cruzada
Temporal</strong></a>
<ul>
<li><a href="#rolling-origin-con-ventana-deslizante" id="toc-rolling-origin-con-ventana-deslizante"><strong>Rolling-Origin
con Ventana Deslizante</strong></a></li>
<li><a href="#validaci%C3%B3n-cruzada-anidada" id="toc-validación-cruzada-anidada"><strong>Validación Cruzada
Anidada</strong></a></li>
</ul></li>
<li><a href="#m%C3%A9tricas-de-evaluaci%C3%B3n" id="toc-métricas-de-evaluación"><strong>Métricas de
Evaluación</strong></a>
<ul>
<li><a href="#m%C3%A9tricas-en-escala" id="toc-métricas-en-escala"><strong>Métricas en Escala</strong></a></li>
<li><a href="#m%C3%A9tricas-relativas" id="toc-métricas-relativas"><strong>Métricas Relativas</strong></a></li>
<li><a href="#m%C3%A9trica-explicativa" id="toc-métrica-explicativa"><strong>Métrica
Explicativa</strong></a></li>
<li><a href="#descomposici%C3%B3n-de-theil" id="toc-descomposición-de-theil"><strong>Descomposición de
Theil</strong></a></li>
</ul></li>
<li><a href="#criterios-de-estabilidad-temporal" id="toc-criterios-de-estabilidad-temporal"><strong>Criterios de
Estabilidad Temporal</strong></a>
<ul>
<li><a href="#m%C3%A9trica-de-soporte" id="toc-métrica-de-soporte"><strong>Métrica de Soporte</strong></a></li>
<li><a href="#umbrales-de-validaci%C3%B3n" id="toc-umbrales-de-validación"><strong>Umbrales de
Validación</strong></a></li>
<li><a href="#m%C3%A9tricas-ajustadas-por-estabilidad" id="toc-métricas-ajustadas-por-estabilidad"><strong>Métricas Ajustadas
por Estabilidad</strong></a></li>
</ul></li>
<li><a href="#implementaci%C3%B3n-computacional" id="toc-implementación-computacional"><strong>Implementación
Computacional</strong></a>
<ul>
<li><a href="#paralelizaci%C3%B3n-multi-nivel" id="toc-paralelización-multi-nivel"><strong>Paralelización
Multi-Nivel</strong></a></li>
<li><a href="#gesti%C3%B3n-de-progreso" id="toc-gestión-de-progreso"><strong>Gestión de
Progreso</strong></a></li>
<li><a href="#complejidad-computacional" id="toc-complejidad-computacional"><strong>Complejidad
Computacional</strong></a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="marco-econométrico-para-el-análisis-de-cointegración-y-corrección-de-errores" class="section level1">
<h1><strong>Marco Econométrico para el Análisis de Cointegración y
Corrección de Errores</strong></h1>
<p>El presente documento detalla la metodología implementada para
evaluar relaciones de equilibrio de largo plazo y dinámicas de ajuste de
corto plazo entre variables de producción y circulación mediante un
enfoque híbrido que combina técnicas econométricas clásicas de
cointegración con métodos modernos de aprendizaje estadístico no
paramétrico. Esta metodología integra el rigor del análisis de
cointegración con la flexibilidad de los Multivariate Adaptive
Regression Splines (MARS) para capturar no-linealidades en el mecanismo
de corrección de errores.</p>
<div id="determinación-de-orden-de-integración-i1" class="section level2">
<h2><strong>Determinación de Orden de Integración I(1)</strong></h2>
<div id="fundamento-teórico" class="section level3">
<h3><strong>Fundamento Teórico</strong></h3>
<p>El análisis de cointegración requiere que las series temporales
involucradas sean integradas de orden uno, denotadas como <span class="math inline">\(I(1)\)</span>. Una serie <span class="math inline">\(I(1)\)</span> es no estacionaria en niveles pero
se vuelve estacionaria tras una diferenciación. Esta propiedad es
fundamental porque solo procesos <span class="math inline">\(I(1)\)</span> pueden mantener relaciones de
equilibrio de largo plazo sin divergir indefinidamente.</p>
</div>
<div id="protocolo-de-verificación" class="section level3">
<h3><strong>Protocolo de Verificación</strong></h3>
<p>Sea <span class="math inline">\(z_t \in \{Y_t, X_t\}\)</span> una
serie temporal. Determinamos que <span class="math inline">\(z_t \sim
I(1)\)</span> mediante el siguiente protocolo de dos etapas:</p>
<p><strong>Etapa 1: No estacionariedad en niveles</strong></p>
<p>Aplicamos el test Augmented Dickey-Fuller (ADF) con componentes
determinísticos:</p>
<p><span class="math display">\[\Delta z_t = \mu + \beta t + \rho
z_{t-1} + \sum_{i=1}^{p} \psi_i \Delta z_{t-i} +
\varepsilon_t\]</span></p>
<p>donde testeamos <span class="math inline">\(H_0: \rho = 0\)</span>
(raíz unitaria). Requerimos fallo en rechazar <span class="math inline">\(H_0\)</span> al 10% de significancia tanto con
drift como con trend, indicando no estacionariedad robusta a la
especificación de determinísticos.</p>
<p><strong>Etapa 2: Estacionariedad en primeras diferencias</strong></p>
<p>Testeamos la primera diferencia sin componentes determinísticos:</p>
<p><span class="math display">\[\Delta^2 z_t = \rho&#39; \Delta z_{t-1}
+ \sum_{i=1}^{p} \psi&#39;_i \Delta^2 z_{t-i} + \eta_t\]</span></p>
<p>Requerimos rechazo de <span class="math inline">\(H_0: \rho&#39; =
0\)</span> al 10%, confirmando estacionariedad tras diferenciación.</p>
</div>
<div id="justificación-del-nivel-de-significancia" class="section level3">
<h3><strong>Justificación del Nivel de Significancia</strong></h3>
<p>Utilizamos 10% en las pruebas <span class="math inline">\(I(1)\)</span> como pre-filtro conservador para
reducir el False Negative Rate (FNR)[^1]. Este umbral más permisivo en
la etapa inicial se compensa con filtros más estrictos en etapas
posteriores (cointegración al 5%, ECM unidireccional al 5%, validación
out-of-sample).</p>
</div>
</div>
<div id="análisis-de-cointegración" class="section level2">
<h2><strong>Análisis de Cointegración</strong></h2>
<div id="enfoque-dual-engle-granger-y-johansen" class="section level3">
<h3><strong>Enfoque Dual: Engle-Granger y Johansen</strong></h3>
<p>Implementamos dos metodologías complementarias de cointegración,
reconociendo que cada una tiene fortalezas específicas:</p>
<div id="procedimiento-engle-granger-con-phillips-ouliaris" class="section level4">
<h4><strong>Procedimiento Engle-Granger con
Phillips-Ouliaris</strong></h4>
<p><strong>Paso 1: Regresión de cointegración</strong></p>
<p>Estimamos la relación de largo plazo:</p>
<p><span class="math display">\[Y_t = \alpha + \beta X_t +
u_t\]</span></p>
<p>donde <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> son los parámetros del vector de
cointegración <span class="math inline">\((1, -\alpha,
-\beta)&#39;\)</span>.</p>
<p><strong>Paso 2: Test de estacionariedad en residuos</strong></p>
<p>Aplicamos dos pruebas sobre <span class="math inline">\(\hat{u}_t\)</span>:</p>
<ul>
<li><strong>ADF sin determinísticos</strong>: Testea raíz unitaria en
los residuos al nivel <span class="math inline">\(p &lt;
0.05\)</span></li>
<li><strong>Phillips-Ouliaris (PO)</strong>: Prueba robusta a
endogeneidad y correlación serial</li>
</ul>
<p><strong>Paso 3: Regla de decisión “either”</strong></p>
<p>Aceptamos cointegración si <strong>cualquiera</strong> de las pruebas
(ADF o PO) valida al 5%. Esta regla reduce FNR en presencia de cambios
estructurales, compensándose con validación posterior más estricta.</p>
</div>
<div id="test-de-johansen-con-traza" class="section level4">
<h4><strong>Test de Johansen con Traza</strong></h4>
<p>Especificamos un VAR de orden <span class="math inline">\(K\)</span>
(seleccionado por criterio BIC via <code>VARselect</code>) y lo
transformamos a su representación VECM:</p>
<p><span class="math display">\[\Delta Z_t = \Pi Z_{t-1} +
\sum_{i=1}^{K-1} \Gamma_i \Delta Z_{t-i} + \Psi D_t +
\varepsilon_t\]</span></p>
<p>donde: - <span class="math inline">\(Z_t = (Y_t, X_t)&#39;\)</span>
es el vector de variables - <span class="math inline">\(\Pi =
\alpha\beta&#39;\)</span> es la matriz de impacto de largo plazo - <span class="math inline">\(D_t\)</span> contiene los determinísticos
(constante y/o tendencia)</p>
<p>Testeamos <span class="math inline">\(H_0: r = 0\)</span> (ningún
vector de cointegración) mediante el estadístico de traza. Probamos con
especificaciones <span class="math inline">\(\{\text{const},
\text{trend}\}\)</span> y aceptamos cointegración si el estadístico
excede el valor crítico al 5% para alguna especificación.</p>
</div>
</div>
<div id="justificación-de-la-regla-either" class="section level3">
<h3><strong>Justificación de la Regla “Either”</strong></h3>
<p>La regla “either” (EG <strong>o</strong> Johansen) en lugar de “both”
(EG <strong>y</strong> Johansen) se justifica por:</p>
<ol style="list-style-type: decimal">
<li><strong>Robustez a cambios de régimen</strong>: Diferentes pruebas
pueden ser sensibles a distintos tipos de quiebres estructurales</li>
<li><strong>Compensación con filtros posteriores</strong>: El ECM con
<span class="math inline">\(\lambda &lt; 0\)</span> y la validación
out-of-sample filtran falsos positivos</li>
<li><strong>Evidencia empírica</strong>: Tests de Monte Carlo muestran
menor FNR sin inflación sustancial de FPR cuando se combina con
validación predictiva</li>
</ol>
</div>
</div>
<div id="modelo-de-corrección-de-errores-ecm" class="section level2">
<h2><strong>Modelo de Corrección de Errores (ECM)</strong></h2>
<div id="especificación-del-ecm-lineal" class="section level3">
<h3><strong>Especificación del ECM Lineal</strong></h3>
<p>Dado el vector de cointegración <span class="math inline">\((\alpha,
\beta)\)</span> de Engle-Granger, construimos:</p>
<p><span class="math display">\[\text{ECM1}_t = Y_{t-1} - \alpha - \beta
X_{t-1}\]</span></p>
<p>Este término captura el desvío del equilibrio de largo plazo en <span class="math inline">\(t-1\)</span>. El modelo ECM completo es:</p>
<p><span class="math display">\[\Delta Y_t = \lambda \cdot \text{ECM1}_t
+ \sum_{i=1}^{L} \phi_i \Delta Y_{t-i} + \sum_{i=1}^{L} \gamma_i \Delta
X_{t-i} + \varepsilon_t\]</span></p>
<p>donde: - <span class="math inline">\(\lambda &lt; 0\)</span> es la
velocidad de ajuste hacia el equilibrio - <span class="math inline">\(L\)</span> es el número de rezagos en diferencias
- <span class="math inline">\(\phi_i, \gamma_i\)</span> capturan la
dinámica de corto plazo</p>
</div>
<div id="selección-óptima-de-rezagos" class="section level3">
<h3><strong>Selección Óptima de Rezagos</strong></h3>
<p>Implementamos un procedimiento de selección automática:</p>
<ol style="list-style-type: decimal">
<li><strong>Búsqueda sobre <span class="math inline">\(L \in \{1, 2,
..., L_{\max}\}\)</span></strong> con <span class="math inline">\(L_{\max} = 4\)</span> por defecto</li>
<li><strong>Criterio primario</strong>: BIC para parsimonia</li>
<li><strong>Restricción de ruido blanco</strong>: Si el modelo con menor
BIC falla Ljung-Box (<span class="math inline">\(p \leq 0.05\)</span>
con 12 rezagos), seleccionamos el modelo con menor BIC que pase la
prueba</li>
<li><strong>Guía opcional</strong>: <span class="math inline">\(L
\approx \max(1, K-1)\)</span> donde <span class="math inline">\(K\)</span> es el orden VAR, aunque no es
vinculante</li>
</ol>
</div>
<div id="test-unidireccional-con-errores-hac" class="section level3">
<h3><strong>Test Unidireccional con Errores HAC</strong></h3>
<div id="hipótesis-y-justificación" class="section level4">
<h4><strong>Hipótesis y Justificación</strong></h4>
<p>Testeamos: - <span class="math inline">\(H_0: \lambda \geq 0\)</span>
(no hay corrección o hay divergencia) - <span class="math inline">\(H_1:
\lambda &lt; 0\)</span> (existe corrección hacia el equilibrio)</p>
<p>La prueba unidireccional es fundamental porque <span class="math inline">\(\lambda &gt; 0\)</span> implicaría divergencia del
equilibrio, lo cual es económicamente incoherente y violaría la
condición de estabilidad del sistema.</p>
</div>
<div id="inferencia-robusta" class="section level4">
<h4><strong>Inferencia Robusta</strong></h4>
<p>Empleamos errores estándar HAC (Heteroskedasticity and
Autocorrelation Consistent) mediante el estimador Newey-West:</p>
<p><span class="math display">\[\hat{V}_{NW} = \hat{\Omega}_0 +
\sum_{j=1}^{m} w_j (\hat{\Omega}_j + \hat{\Omega}&#39;_j)\]</span></p>
<p>donde <span class="math inline">\(w_j = 1 - j/(m+1)\)</span> son los
pesos de Bartlett y <span class="math inline">\(m\)</span> se selecciona
automáticamente. El estadístico <span class="math inline">\(t\)</span>
robusto es:</p>
<p><span class="math display">\[t =
\frac{\hat{\lambda}}{\sqrt{\hat{V}_{NW,\lambda\lambda}}}\]</span></p>
<p>con p-valor unidireccional <span class="math inline">\(p = P(T \leq t
| H_0)\)</span>. Rechazamos si <span class="math inline">\(p &lt;
0.05\)</span> <strong>y</strong> <span class="math inline">\(\hat{\lambda} &lt; 0\)</span>.</p>
</div>
</div>
</div>
<div id="extensión-no-lineal-con-mars" class="section level2">
<h2><strong>Extensión No-Lineal con MARS</strong></h2>
<div id="motivación-económica" class="section level3">
<h3><strong>Motivación Económica</strong></h3>
<p>Las relaciones económicas frecuentemente exhiben no-linealidades: -
<strong>Efectos umbral</strong>: Respuestas diferentes según el nivel de
las variables - <strong>Asimetrías</strong>: Ajustes diferentes para
desvíos positivos vs negativos - <strong>Cambios de régimen</strong>:
Parámetros variables según el contexto económico</p>
<p>MARS captura estas características mediante funciones base
adaptativas sin requerir especificación <em>a priori</em> de la forma
funcional.</p>
</div>
<div id="especificación-del-modelo-mars-ecm" class="section level3">
<h3><strong>Especificación del Modelo MARS-ECM</strong></h3>
<p>El modelo no-lineal se especifica como:</p>
<p><span class="math display">\[\Delta Y_t = f(\text{ECM1}_t, \Delta
X_t, \Delta Y_{t-1}, \Delta X_{t-1}, \Delta Y_{t-2}) +
\eta_t\]</span></p>
<p>donde <span class="math inline">\(f(\cdot)\)</span> es aproximada por
MARS como:</p>
<p><span class="math display">\[f(\mathbf{x}) = \beta_0 + \sum_{m=1}^{M}
\beta_m \prod_{k=1}^{K_m} h_{km}(x_{v(k,m)})\]</span></p>
<p>con: - <span class="math inline">\(h_{km}\)</span> son funciones
bisagra: <span class="math inline">\(\max(0, x - c)\)</span> o <span class="math inline">\(\max(0, c - x)\)</span> - <span class="math inline">\(M\)</span> es el número de funciones base
(controlado por <code>nk</code>) - <span class="math inline">\(K_m\)</span> es el grado de interacción
(controlado por <code>degree</code>)</p>
</div>
<div id="configuración-de-hiperparámetros" class="section level3">
<h3><strong>Configuración de Hiperparámetros</strong></h3>
<p>La grilla de búsqueda especifica: - <strong>degree</strong> <span class="math inline">\(\in \{1, 2\}\)</span>: Controla interacciones (1 =
aditivo, 2 = permite interacciones) - <strong>nk</strong> <span class="math inline">\(\in \{15, 25, 35, 50, 65\}\)</span>: Número máximo
de términos antes de poda</p>
<p>Esta grilla balancea flexibilidad con riesgo de sobreajuste, siendo
expandible con más datos históricos.</p>
</div>
</div>
<div id="validación-cruzada-temporal" class="section level2">
<h2><strong>Validación Cruzada Temporal</strong></h2>
<div id="rolling-origin-con-ventana-deslizante" class="section level3">
<h3><strong>Rolling-Origin con Ventana Deslizante</strong></h3>
<p>Implementamos validación cruzada temporal respetando la causalidad
mediante rolling-origin con ventana deslizante (<em>sliding
window</em>):</p>
<div id="parámetros-de-configuración" class="section level4">
<h4><strong>Parámetros de Configuración</strong></h4>
<ul>
<li><strong>Tamaño inicial</strong>: <span class="math inline">\(\max(40, 0.80 \times n)\)</span>
observaciones</li>
<li><strong>Horizonte de test</strong>: 12 meses (pronóstico anual)</li>
<li><strong>Paso entre orígenes</strong>: 12 meses (evita
solapamiento)</li>
<li><strong>Tipo de ventana</strong>: Sliding (tamaño constante) vs
Expanding (acumulativa)</li>
</ul>
</div>
<div id="justificación-de-sliding-window" class="section level4">
<h4><strong>Justificación de Sliding Window</strong></h4>
<p>La ventana deslizante mantiene “memoria comparable” entre folds y es
más sensible a cambios de régimen que la expansiva. Esto es crucial para
series económicas con parámetros no constantes en sentido amplio.
Evidencia empírica muestra que sliding:</p>
<ol style="list-style-type: decimal">
<li>Preserva estabilidad global (mismo número de modelos robustos)</li>
<li>Aumenta sensibilidad local (detecta más relaciones
régimen-dependientes)</li>
<li>Mejora adaptación a dinámicas recientes</li>
</ol>
</div>
</div>
<div id="validación-cruzada-anidada" class="section level3">
<h3><strong>Validación Cruzada Anidada</strong></h3>
<p>Para selección de hiperparámetros sin contaminar la evaluación:</p>
<ol style="list-style-type: decimal">
<li><strong>Nivel externo</strong>: Rolling-origin para evaluación de
desempeño</li>
<li><strong>Nivel interno</strong>: Dentro de cada train externo,
rolling-origin adicional con:
<ul>
<li>Inicial: 60% del train externo</li>
<li>Test interno: 6 meses</li>
<li>Paso interno: 3 meses</li>
</ul></li>
</ol>
<p>Esta estructura evita <em>data snooping</em>[^2] y proporciona
estimaciones no sesgadas del error de generalización.</p>
</div>
</div>
<div id="métricas-de-evaluación" class="section level2">
<h2><strong>Métricas de Evaluación</strong></h2>
<div id="métricas-en-escala" class="section level3">
<h3><strong>Métricas en Escala</strong></h3>
<ul>
<li><strong>RMSE</strong>: <span class="math inline">\(\sqrt{\frac{1}{n}\sum_{t=1}^n (Y_t -
\hat{Y}_t)^2}\)</span></li>
<li><strong>MAE</strong>: <span class="math inline">\(\frac{1}{n}\sum_{t=1}^n |Y_t -
\hat{Y}_t|\)</span></li>
</ul>
</div>
<div id="métricas-relativas" class="section level3">
<h3><strong>Métricas Relativas</strong></h3>
<ul>
<li><strong>MAPE</strong>: <span class="math inline">\(\frac{100}{n}\sum_{t=1}^n \left|\frac{Y_t -
\hat{Y}_t}{Y_t}\right|\)</span> (protegido para <span class="math inline">\(|Y_t| &gt; \epsilon\)</span>)</li>
<li><strong>sMAPE</strong>: <span class="math inline">\(\frac{100}{n}\sum_{t=1}^n \frac{2|Y_t -
\hat{Y}_t|}{|Y_t| + |\hat{Y}_t|}\)</span></li>
<li><strong>Theil’s U</strong>: <span class="math inline">\(\frac{\sqrt{\overline{(Y_t -
\hat{Y}_t)^2}}}{\sqrt{\overline{Y_t^2}}}\)</span></li>
</ul>
</div>
<div id="métrica-explicativa" class="section level3">
<h3><strong>Métrica Explicativa</strong></h3>
<ul>
<li><strong><span class="math inline">\(R^2\)</span> protegido</strong>:
<span class="math display">\[R^2 = \begin{cases}
1 - \frac{\sum(Y_t - \hat{Y}_t)^2}{\sum(Y_t - \bar{Y})^2} &amp; \text{si
} SST &gt; \epsilon \\
\text{NA} &amp; \text{si } SST \leq \epsilon
\end{cases}\]</span></li>
</ul>
</div>
<div id="descomposición-de-theil" class="section level3">
<h3><strong>Descomposición de Theil</strong></h3>
<p>El MSE se descompone en componentes interpretables:</p>
<p><span class="math display">\[\text{MSE} = \underbrace{(\bar{\hat{Y}}
- \bar{Y})^2}_{\text{Sesgo}^2} + \underbrace{(\sigma_{\hat{Y}} -
\sigma_Y)^2}_{\text{Var. diferencial}} +
\underbrace{2\sigma_{\hat{Y}}\sigma_Y(1 -
\rho_{\hat{Y},Y})}_{\text{Covarianza imperfecta}}\]</span></p>
<p>Las proporciones (bias_prop, var_prop, cov_prop) diagnostican la
fuente principal del error predictivo.</p>
</div>
</div>
<div id="criterios-de-estabilidad-temporal" class="section level2">
<h2><strong>Criterios de Estabilidad Temporal</strong></h2>
<div id="métrica-de-soporte" class="section level3">
<h3><strong>Métrica de Soporte</strong></h3>
<p>Definimos el soporte como:</p>
<p><span class="math display">\[\text{support} =
\frac{\text{folds\_proceed}}{\text{folds}}\]</span></p>
<p>donde <code>folds_proceed</code> cuenta los folds que pasan todos los
filtros econométricos y tienen desempeño predictivo aceptable.</p>
</div>
<div id="umbrales-de-validación" class="section level3">
<h3><strong>Umbrales de Validación</strong></h3>
<ul>
<li><strong>Umbral estricto</strong>: support <span class="math inline">\(\geq 0.75\)</span> <strong>y</strong>
folds_proceed <span class="math inline">\(\geq 5\)</span></li>
<li><strong>Umbral moderado</strong>: support <span class="math inline">\(\geq 0.60\)</span> <strong>y</strong>
folds_proceed <span class="math inline">\(\geq 3\)</span></li>
</ul>
<p>El requisito de mínimo absoluto previene “falsos robustos” por
denominador pequeño.</p>
</div>
<div id="métricas-ajustadas-por-estabilidad" class="section level3">
<h3><strong>Métricas Ajustadas por Estabilidad</strong></h3>
<ul>
<li><strong><span class="math inline">\(R^2\)</span> estable</strong>:
<span class="math inline">\(R^2_{\text{stab}} = R^2 \times
\text{support}\)</span></li>
<li><strong>U estable</strong>: <span class="math inline">\(U_{\text{stab}} =
\frac{U}{\text{support}}\)</span> (penaliza inestabilidad)</li>
</ul>
<p>Estas métricas integran desempeño predictivo con consistencia
temporal, privilegiando modelos “buenos y constantes” sobre “excelentes
a veces”.</p>
</div>
</div>
<div id="implementación-computacional" class="section level2">
<h2><strong>Implementación Computacional</strong></h2>
<div id="paralelización-multi-nivel" class="section level3">
<h3><strong>Paralelización Multi-Nivel</strong></h3>
<p>La arquitectura de paralelización opera en dos niveles:</p>
<ol style="list-style-type: decimal">
<li><strong>Nivel de pares</strong>: Cada combinación <span class="math inline">\((X \to Y)\)</span> se procesa en un worker
independiente</li>
<li><strong>Control de BLAS</strong>: Se fija
<code>blas_set_num_threads(1)</code> para evitar sobre-suscripción del
CPU</li>
</ol>
<p>Los workers son procesos R independientes (no threads) coordinados
por <code>future::multisession</code>, cada uno con memoria propia. La
semilla <code>future.seed=TRUE</code> garantiza reproducibilidad en
paralelo.</p>
</div>
<div id="gestión-de-progreso" class="section level3">
<h3><strong>Gestión de Progreso</strong></h3>
<p>El paquete <code>progressr</code> proporciona retroalimentación en
tiempo real sin interferir con la paralelización, crucial para
ejecuciones largas (84 pares × múltiples folds × validación
anidada).</p>
</div>
<div id="complejidad-computacional" class="section level3">
<h3><strong>Complejidad Computacional</strong></h3>
<p>La complejidad total es:</p>
<p><span class="math display">\[\mathcal{O}(N_{\text{pares}} \times
F_{\text{ext}} \times F_{\text{int}} \times G \times
C_{\text{modelo}})\]</span></p>
<p>donde: - <span class="math inline">\(N_{\text{pares}} = 84\)</span>
(6 circulación × 7 producción × 2 direcciones) - <span class="math inline">\(F_{\text{ext}}\)</span> = número de folds externos
(típicamente 8-15) - <span class="math inline">\(F_{\text{int}}\)</span>
= folds internos por fold externo (típicamente 3-5) - <span class="math inline">\(G\)</span> = tamaño de</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
